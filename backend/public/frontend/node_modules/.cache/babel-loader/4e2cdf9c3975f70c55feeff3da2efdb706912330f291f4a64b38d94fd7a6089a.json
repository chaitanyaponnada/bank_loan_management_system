{"ast":null,"code":"import React,{useState}from'react';import'./Ledger.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const API_URL='http://localhost:3001/api/v1';function Ledger(){var _result$emis_left;const[loanId,setLoanId]=useState('');const[result,setResult]=useState(null);const[error,setError]=useState('');const handleFetch=async e=>{e.preventDefault();if(!loanId.trim())return;setError('');setResult(null);try{const response=await fetch(`${API_URL}/loans/${loanId}/ledger`);const data=await response.json();if(!response.ok)throw new Error(data.error||'Failed to fetch ledger.');setResult(data);}catch(err){setError(err.message);}};const formatStatus=function(){let status=arguments.length>0&&arguments[0]!==undefined?arguments[0]:'';return status.replace(/_/g,' ').toUpperCase();};const formatCurrency=value=>isNaN(value)?'N/A':`₹${parseFloat(value).toLocaleString('en-IN')}`;return/*#__PURE__*/_jsxs(\"div\",{className:\"ledger-container\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"component-title\",children:\"View Loan Ledger\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleFetch,className:\"form-container\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:loanId,onChange:e=>setLoanId(e.target.value),placeholder:\"Enter Loan ID\",required:true}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"Get Ledger\"})]}),error&&/*#__PURE__*/_jsx(\"p\",{className:\"error\",children:error}),result&&/*#__PURE__*/_jsxs(\"div\",{className:\"ledger-results\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"ledger-header\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"customer-name\",children:result.customer_name}),/*#__PURE__*/_jsxs(\"div\",{className:\"loan-meta\",children:[/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Loan ID:\"}),\" \",/*#__PURE__*/_jsx(\"code\",{children:result.loan_id})]}),/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Status:\"}),/*#__PURE__*/_jsx(\"span\",{className:`status-badge status-${result.status}`,children:formatStatus(result.status)})]}),/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"EMIs Left:\"}),\" \",(_result$emis_left=result.emis_left)!==null&&_result$emis_left!==void 0?_result$emis_left:'N/A']})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"ledger-summary-grid\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"data-point\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Principal\"}),/*#__PURE__*/_jsx(\"span\",{children:formatCurrency(result.principal)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"data-point\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Total Payable\"}),/*#__PURE__*/_jsx(\"span\",{children:formatCurrency(result.total_amount)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"data-point\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Amount Paid\"}),/*#__PURE__*/_jsx(\"span\",{children:formatCurrency(result.amount_paid)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"data-point\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Balance\"}),/*#__PURE__*/_jsx(\"span\",{children:formatCurrency(result.balance_amount)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"data-point\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Monthly EMI\"}),/*#__PURE__*/_jsx(\"span\",{children:formatCurrency(result.monthly_emi)})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"transactions-section\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"Transactions\"}),/*#__PURE__*/_jsx(\"div\",{className:\"table-wrapper\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"transactions-table\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Transaction ID\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Date & Time (IST)\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Type\"}),/*#__PURE__*/_jsx(\"th\",{className:\"amount-header\",children:\"Amount\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:Array.isArray(result.transactions)&&result.transactions.length>0?result.transactions.map(tx=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:tx.transaction_id}),/*#__PURE__*/_jsx(\"td\",{children:tx.date?new Date(tx.date).toLocaleString('en-IN',{timeZone:'Asia/Kolkata'}):'N/A'}),/*#__PURE__*/_jsx(\"td\",{children:tx.type||'N/A'}),/*#__PURE__*/_jsx(\"td\",{className:\"amount-cell\",children:formatCurrency(tx.amount)})]},tx.transaction_id)):/*#__PURE__*/_jsx(\"tr\",{children:/*#__PURE__*/_jsx(\"td\",{colSpan:\"4\",className:\"no-transactions\",children:\"No transactions found for this loan.\"})})})]})})]})]})]});}export default Ledger;","map":{"version":3,"names":["React","useState","jsx","_jsx","jsxs","_jsxs","API_URL","Ledger","_result$emis_left","loanId","setLoanId","result","setResult","error","setError","handleFetch","e","preventDefault","trim","response","fetch","data","json","ok","Error","err","message","formatStatus","status","arguments","length","undefined","replace","toUpperCase","formatCurrency","value","isNaN","parseFloat","toLocaleString","className","children","onSubmit","type","onChange","target","placeholder","required","customer_name","loan_id","emis_left","principal","total_amount","amount_paid","balance_amount","monthly_emi","Array","isArray","transactions","map","tx","transaction_id","date","Date","timeZone","amount","colSpan"],"sources":["C:/Users/chait/OneDrive/Desktop/Projects/bank-loan-management-system/frontend/src/components/Ledger/Ledger.js"],"sourcesContent":["import React, { useState } from 'react';\r\nimport './Ledger.css';\r\n\r\nconst API_URL = 'http://localhost:3001/api/v1';\r\n\r\nfunction Ledger() {\r\n    const [loanId, setLoanId] = useState('');\r\n    const [result, setResult] = useState(null);\r\n    const [error, setError] = useState('');\r\n\r\n    const handleFetch = async (e) => {\r\n        e.preventDefault();\r\n        if (!loanId.trim()) return;\r\n\r\n        setError('');\r\n        setResult(null);\r\n        try {\r\n            const response = await fetch(`${API_URL}/loans/${loanId}/ledger`);\r\n            const data = await response.json();\r\n            if (!response.ok) throw new Error(data.error || 'Failed to fetch ledger.');\r\n            setResult(data);\r\n        } catch (err) {\r\n            setError(err.message);\r\n        }\r\n    };\r\n\r\n    const formatStatus = (status = '') => status.replace(/_/g, ' ').toUpperCase();\r\n    const formatCurrency = (value) =>\r\n        isNaN(value) ? 'N/A' : `₹${parseFloat(value).toLocaleString('en-IN')}`;\r\n\r\n    return (\r\n        <div className=\"ledger-container\">\r\n            <h2 className=\"component-title\">View Loan Ledger</h2>\r\n\r\n            <form onSubmit={handleFetch} className=\"form-container\">\r\n                <input\r\n                    type=\"text\"\r\n                    value={loanId}\r\n                    onChange={(e) => setLoanId(e.target.value)}\r\n                    placeholder=\"Enter Loan ID\"\r\n                    required\r\n                />\r\n                <button type=\"submit\">Get Ledger</button>\r\n            </form>\r\n\r\n            {error && <p className=\"error\">{error}</p>}\r\n\r\n            {result && (\r\n                <div className=\"ledger-results\">\r\n                    <div className=\"ledger-header\">\r\n                        <h3 className=\"customer-name\">{result.customer_name}</h3>\r\n                        <div className=\"loan-meta\">\r\n                            <span><strong>Loan ID:</strong> <code>{result.loan_id}</code></span>\r\n                            <span><strong>Status:</strong> \r\n                                <span className={`status-badge status-${result.status}`}>{formatStatus(result.status)}</span>\r\n                            </span>\r\n                            <span><strong>EMIs Left:</strong> {result.emis_left ?? 'N/A'}</span>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className=\"ledger-summary-grid\">\r\n                        <div className=\"data-point\">\r\n                            <label>Principal</label>\r\n                            <span>{formatCurrency(result.principal)}</span>\r\n                        </div>\r\n                        <div className=\"data-point\">\r\n                            <label>Total Payable</label>\r\n                            <span>{formatCurrency(result.total_amount)}</span>\r\n                        </div>\r\n                        <div className=\"data-point\">\r\n                            <label>Amount Paid</label>\r\n                            <span>{formatCurrency(result.amount_paid)}</span>\r\n                        </div>\r\n                        <div className=\"data-point\">\r\n                            <label>Balance</label>\r\n                            <span>{formatCurrency(result.balance_amount)}</span>\r\n                        </div>\r\n                        <div className=\"data-point\">\r\n                            <label>Monthly EMI</label>\r\n                            <span>{formatCurrency(result.monthly_emi)}</span>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className=\"transactions-section\">\r\n                        <h4>Transactions</h4>\r\n                        <div className=\"table-wrapper\">\r\n                            <table className=\"transactions-table\">\r\n                                <thead>\r\n                                    <tr>\r\n                                        <th>Transaction ID</th>\r\n                                        <th>Date & Time (IST)</th>\r\n                                        <th>Type</th>\r\n                                        <th className=\"amount-header\">Amount</th>\r\n                                    </tr>\r\n                                </thead>\r\n                                <tbody>\r\n                                    {Array.isArray(result.transactions) && result.transactions.length > 0 ? (\r\n                                        result.transactions.map((tx) => (\r\n                                            <tr key={tx.transaction_id}>\r\n                                                <td>{tx.transaction_id}</td>\r\n                                                <td>{tx.date ? new Date(tx.date).toLocaleString('en-IN', { timeZone: 'Asia/Kolkata' }) : 'N/A'}</td>\r\n                                                <td>{tx.type || 'N/A'}</td>\r\n                                                <td className=\"amount-cell\">{formatCurrency(tx.amount)}</td>\r\n                                            </tr>\r\n                                        ))\r\n                                    ) : (\r\n                                        <tr>\r\n                                            <td colSpan=\"4\" className=\"no-transactions\">No transactions found for this loan.</td>\r\n                                        </tr>\r\n                                    )}\r\n                                </tbody>\r\n                            </table>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default Ledger;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}